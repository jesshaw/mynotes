---
title: 前端优化
tags: FEO, 前端优化
categories: 
  - js

thumbnail: /gallery/blue-water2.jpg
---
前端优化（FEO），也称为内容优化，就是对网站进行微调，使其更易于浏览和更快加载。
<!-- more -->

“前端”指的是浏览器和站点间的交互。前端优化（FEO），也称为内容优化，就是对网站进行微调，使其更易于浏览和更快加载。

一般来说，FEO专注于减少文件大小并最大限度地减少给定页面加载所需的请求数量。

在FEO过程中，网页设计师在感知页面加载时间和实际页面加载时间之间进行区分。 感知的加载时间被认为是因为它对整体用户体验（UX）的影响，而**实际加载时间通常用作性能基准测量指标**。

内容分发网络（CDN）在FEO前端优化过程中扮演着重要角色，因为它们通常用于简化许多时间要求苛刻的优化任务。 例如，一个典型的CDN提供自动文件压缩和自动缩小功能，使您不必手动修改个人网站资源。

## 案例：第一个字节的时间（Time to First Byte ：TTFB）
	
**第一个字节的时间通常用于衡量网站的响应时间**，这是最重要的 - 也是最容易被误解的性能指标之一。

从实际加载时间角度来看，TTFB是第一个数据字节从服务器到达请求浏览器所需的时间。 然而，从感知加载时间的角度来看，TTFB是浏览器在下载HTML文件后解析第一个字节所需的时间。

只有认知的TTFB会影响用户体验，使其成为这两个指标中更有价值的。

## 有几种方法可以提高您的网站响应能力：

1. 减少HTTP请求
2. 文件压缩
3. 缓存优化
4. 代码最小化
5. 图片优化

## 减少HTTP请求


在加载网页时，浏览器必须为每个HTTP请求打开一个单独的TCP连接，这与所需下载的页面元素数量相等。

问题在于浏览器可以向单个主机打开的并发连接数有限制。 此限制旨在保护服务器免受大量HTTP请求的过载。 但是，它也可能成为潜在的瓶颈，通常会迫使浏览器开始排队连接请求。

由于快速达到最大连接阈值，因此采用各种FEO技术来最小化单个页面元素的数量。 其中最常见的是资源整合 - 将多个小文件捆绑在一起的做法。


### 例如…
假设您的网站模板由一个HTML文件，两个CSS文件和16个图像组成 - 包括您的徽标和各种菜单背景。 总的来说，浏览器需要制作19个HTTP请求才能在您的网站上加载一个空白页面。

使用Google Chrome浏览器的访问者一次只能打开六个与服务器的TCP连接，因此浏览器必须排队处理剩余的13个请求。

但是，如果将所有模板图像合并为一个精灵图像，则可以将请求数从19减少到4。

这不仅让Chrome在一次“坐着”中解析页面，而且还减少了加载页面所需的往返次数 。


### CDN因素
CDN可通过预先汇集连接并确保它们在整个会话期间保持打开状态，从而进一步缩短服务器响应时间。

虽然CDN本身不会减少请求的数量，但通过消除与关闭和重新打开TCP连接相关的延迟时间，预池可以提高性能。

注意： HTTP / 2协议仍然在早期 
采用阶段，引入了多路复用 - 一种允许通过单个TCP连接发送多个请求和响应的连接方法。

在不久的将来，这可能会减少资源捆绑的好处。

## 文件压缩
每个网站页面都是由HTML，JavaScript，CSS和（可能）其他代码文件构成的。 页面越复杂，代码文件越大，加载时间越长。

通过文件压缩，这些文件可以缩小到其原始大小的一小部分，以提高网站的响应速度。 由于其快速编码/解码时间和高压缩率， gzip是最流行的文件压缩选择。 它可以将代码文件缩小多达60甚至80％。

注意：缩小图像无法有效减小图像文件的大小，因为它们已经被压缩。
在一定程度上，Gzip的优势在于它能够将所有文件整合到一个压缩的tar文件（aka，tarball）中。 缺点是它阻止了单个文件的提取。 然而，这对Web内容来说并不是问题，因为无论如何都必须解压缩整个页面才能正确加载。


### CDN因素
几乎所有的CDN都提供自动文件压缩功能，无缝地将所有可压缩代码文件（例如CSS和JS文件）提供给网站访问者。

## 缓存优化
HTTP缓存头在浏览器解析网站的方式中扮演着重要角色，因为他们确定哪些内容项目被缓存以及多长时间。

缓存存储您的静态文件，通常是您的服务器之外的最大的静态文件 - 无论是访客的本地驱动器还是附近的CDN PoP。 这可以大大提高网站的加载速度。

缺点是手动缓存头管理可能是一项繁琐而低效的任务。 而且，缓存机制在处理页面开始加载时动态生成的动态内容（例如，AJAX对象，甚至动态生成的HTML文件）时经常遇到问题。
缓存优化

### CDN因素
许多CDN通常通过用户友好的仪表板提供缓存控制选项。 通过它，他们允许您设置站点范围策略，管理单个项目的缓存规则，甚至根据文件类型和位置等内容设置整个文件组的策略（例如，始终将所有图像缓存到“/ blog /”文件夹60天）。

CDN也开始整合机器学习技术。 这些遵循内容使用模式来自动优化高速缓存策略，从而缓存通常“不可缓存”的动态内容。 这可以缓解几乎所有的缓存管理任务。

## 代码缩小

Minification是一个FEO过程，可以识别开发人员编写代码的方式以及机器如何读取代码。

这个想法是，尽管开发人员编写易于阅读理解的代码，包括空格，换行符和注释，但机器可以在没有任何这些元素的情况下阅读它们，从而使其成为不必要的字符

缩小将代码修剪为最基本的要素，在压缩之前通常将其缩减一半。
缩小前后
缩小之前
缩小前（201个字符）
 缩小后
缩小后（137个字符）=文件大小减少30％

### CDN因素

CDN有能力完全自动化代码缩小。 作为一项优质的服务，已经为网站的大部分内容提供服务，CDN非常容易在发送到访问者的浏览器时轻松缩小所有JavaScript，HTML和CSS文件。

### Gzip和Minify：

虽然缩小和缩小代码可能看起来多余，但将这两种方法结合起来可以提供最佳结果。

因此，在对它们进行gzip压缩之前缩小文件会将tarfile大小再缩小5％到10％。

## 图像优化

缓存和压缩是两种最常见的图像优化方法，其中缓存更有效。 这是因为，与代码文件不同，所有图像格式都已被压缩。

因此，为了进一步减少图像文件的大小，您必须通过删除某些标题信息或降低原始图像质量来篡改该图像的数据。 这被称为有损压缩。
图像优化
注意：尽管丢弃数据和降低分辨率通常是无人看管的，但有损压缩对于某些高分辨率图像可能有用，因为我们的眼睛无法自然地感知到这些图像所具有的全部视觉信息。

例如，有损压缩可以消除色彩层次并降低像素复杂度，而不会明显影响我们对图像的感知。

### CDN因素

CDN是图像缓存的首选解决方案，通常仅为此目的购买。 此外，一些CDN还有助于自动化图像压缩过程，让您在页面加载速度和图像质量之间进行选择。

更高级的CDN也提供了渐进式渲染选项，对原有的有损压缩概念进行了修改。 随着渐进式渲染，CDN快速加载图像的像素化版本。 然后，CDN逐渐用一系列逐渐变得更好和更好看的变体替换它，直到实际图像准备好加载。

渐进式渲染有助于减少感知的加载时间而不牺牲图像质量。

渐进渲染进行中
渐进渲染进行中

### 矢量和光栅图像
另一种图像优化技术是用它们的向量替换一些常规（光栅）图像。

该技术适用于由简单几何形状组成的图像：线条，曲线，多边形等。典型的矢量图像是图标或图表。

您应该尽可能使用矢量图像，因为：

它们的尺寸非常小，因为它们只需要为一组坐标保存数据，而不是针对每个像素。
独立于解决方案，他们可以无限放大和缩小，而不影响质量。 这使得它们适用于响应式设计。

[FEO](https://www.incapsula.com/cdn-guide/front-end-optimization-feo.html)