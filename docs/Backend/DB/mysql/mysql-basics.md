# MySql 相关知识

## 事务的隔离级别

| 隔离级别 | 脏读 | 不可重复读 | 幻读 |
|----------|------|-------------|------|
| READ UNCOMMITTED (读未提交) | 可能 | 可能 | 可能 |
| READ COMMITTED (读已提交) | 不可能 | 可能 | 可能 |
| REPEATABLE READ (可重复读) | 不可能 | 不可能 | 可能 |
| SERIALIZABLE (串行化) | 不可能 | 不可能 | 不可能 |

- **脏读**：一个事务读取到了另一个事务未提交的数据。
- **不可重复读**：在同一个事务中，多次读取同一数据，在两次读取之间，其他事务修改了该数据并提交。
- **幻读**：在一个事务内，对同一查询执行多次，结果集不同。例如，第一次查询时只有3条记录，但更新操作却影响了4条记录。

## 事务的特点 - ACID

- **原子性（Atomicity）**：事务中的所有操作要么全部完成，要么全部不完成。
- **一致性（Consistency）**：事务执行前后，数据库必须保持一致状态，满足业务规则约束。
- **隔离性（Isolation）**：并发执行的事务互相隔离，互不影响。
- **持久性（Durability）**：一旦事务提交，其结果是永久性的，即使系统故障也能恢复。

## SQL 连接类型及语法

- **左连接（Left Join）**：返回左表的所有记录，以及右表中匹配的记录；如果右表没有匹配，则结果为NULL。

  ```sql
  SELECT a.*, b.* FROM a LEFT JOIN b ON a.b_id = b.id;
  ```

- **右连接（Right Join）**：返回右表的所有记录，以及左表中匹配的记录；如果左表没有匹配，则结果为NULL。

  ```sql
  SELECT a.*, b.* FROM a RIGHT JOIN b ON a.b_id = b.id;
  ```

- **内连接（Inner Join）**：仅返回两个表中匹配的记录。

  ```sql
  SELECT a.*, b.* FROM a INNER JOIN b ON a.b_id = b.id;
  ```

## 常用聚合函数及其作用

- **COUNT(*|列)**：计算指定列或整个表中的记录数。
- **SUM(列)**：计算指定列的总和。
- **AVG(列)**：计算指定列的平均值。
- **MAX(列)**：返回指定列的最大值。
- **MIN(列)**：返回指定列的最小值。

示例：

```sql
SELECT MAX(age) FROM t_student;
SELECT MIN(age) FROM t_student;
```

## 数据库设计的三大范式及反范式

1. **第一范式（1NF）**：确保每列都是不可再分的原子列。
2. **第二范式（2NF）**：在满足第一范式的前提下，非主键字段完全依赖于主键。
3. **第三范式（3NF）**：在满足第二范式的前提下，消除传递依赖。

**反范式设计**：

- **提高查询效率**：通过冗余存储一些数据来减少多表联查的需求，适用于读多写少的场景。
- **保存历史快照信息**：某些情况下，需要保留特定时间点的数据快照，比如订单中的收货人信息，以防止后续变更导致的历史数据丢失。

反范式设计虽然提高了查询性能，但也增加了数据冗余和维护成本，因此需要根据具体应用场景权衡使用。
