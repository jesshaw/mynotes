# ORM常用的设计模式

ORM（对象关系映射）通常会使用以下几种常见的设计模式来实现其功能：

1. **数据访问对象模式（DAO - Data Access Object Pattern）**  
   DAO模式将数据库操作封装到单独的类中，每个DAO类负责与数据库表交互，提供访问数据库的统一接口。这样做可以将数据访问逻辑与业务逻辑分离，提高代码的可维护性。

2. **活动记录模式（Active Record Pattern）**  
   在活动记录模式中，每个对象直接映射到数据库中的一行记录。对象中的属性与数据库字段对应，对象方法则用于执行CRUD（创建、读取、更新、删除）操作。这种模式的优点是简单易用，但在复杂场景下可能难以维护。

3. **表数据网关模式（Table Data Gateway Pattern）**  
   该模式通过一个类来处理所有与特定数据库表相关的操作。每个表对应一个网关类，类中的方法用于处理数据库表的查询、插入、更新和删除操作。这种模式也有助于将业务逻辑与数据库访问逻辑分开。

4. **工作单元模式（Unit of Work Pattern）**  
   工作单元模式用于跟踪一个事务中的多个操作，并确保所有操作在事务结束时一次性提交。ORM框架通常会将对数据库的操作暂时保存起来，直到执行`commit`操作时才将所有改动提交。这种模式帮助保持数据的一致性。

5. **懒加载模式（Lazy Load Pattern）**  
   ORM常用懒加载来提高性能，只有在访问对象的某些属性时，才会从数据库中加载相关数据。这可以避免不必要的数据库查询，但需要谨慎使用，以避免导致N+1查询问题。

6. **身份映射模式（Identity Map Pattern）**  
   该模式通过维护一个缓存，避免在同一事务中多次查询数据库中相同的对象。ORM使用身份映射来保证同一个数据库记录在程序中只会对应一个对象实例，从而减少不必要的数据库访问。

7. **存储库模式（Repository Pattern）**  
   存储库模式为访问聚合根（一个业务逻辑上的实体集合）提供了一个抽象层，它将数据获取、保存等操作隐藏在接口之后，方便维护和修改。ORM可以通过存储库来管理实体的生命周期以及其与数据库之间的交互。

这些设计模式各自有不同的优缺点，ORM通常会结合多个模式来实现高效、灵活的数据库操作。
